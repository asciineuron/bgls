<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="How BGLS works" href="how_it_works.html" /><link rel="prev" title="Using custom states with BGLS" href="using_custom_states.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Features - BGLS documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">BGLS  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">BGLS  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="when_to_use.html">When to use <code class="docutils literal notranslate"><span class="pre">BGLS</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="using_custom_states.html">Using custom states with <code class="docutils literal notranslate"><span class="pre">BGLS</span></code></a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_it_works.html">How <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> works</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">Tips for using <code class="docutils literal notranslate"><span class="pre">BGLS</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="clifford_simulation.html">Using BGLS on Clifford and near-Clifford circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="mps_simulation.html">Using BGLS to sample from Matrix Product State Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="qaoa_example.html">Using BGLS with MPS to solve QAOA problems</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="features">
<h1>Features<a class="headerlink" href="#features" title="Permalink to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">BGLS</span></code> supports several useful features when simulating circuits, described below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Setup.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">cirq</span>

<span class="kn">import</span> <span class="nn">bgls</span>
</pre></div>
</div>
</div>
</div>
<section id="accessing-final-states">
<h2>Accessing final states<a class="headerlink" href="#accessing-final-states" title="Permalink to this heading">#</a></h2>
<p>While measurement results (samples) are returned, final states are stored and can be accessed from <code class="docutils literal notranslate"><span class="pre">bgls.Simulator.final_states</span></code> as below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">a</span><span class="p">),</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">bgls</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">cirq</span><span class="o">.</span><span class="n">StateVectorSimulationState</span><span class="p">(</span>
        <span class="n">qubits</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">initial_state</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">),</span>
    <span class="n">apply_op</span><span class="o">=</span><span class="n">cirq</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">act_on</span><span class="p">,</span>
    <span class="n">compute_probability</span><span class="o">=</span><span class="n">bgls</span><span class="o">.</span><span class="n">born</span><span class="o">.</span><span class="n">compute_probability_state_vector</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">repetitions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results:&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>

<span class="n">final_state</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">final_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final state:&quot;</span><span class="p">,</span> <span class="n">cirq</span><span class="o">.</span><span class="n">dirac_notation</span><span class="p">(</span><span class="n">final_state</span><span class="o">.</span><span class="n">target_tensor</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Results: z=0000001111, 0000001111
Final state: 0.71|00⟩ + 0.71|11⟩
</pre></div>
</div>
</div>
</div>
<p>Note that here, although we sampled multiple times, there is only one final state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">final_states</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>This is because <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> samples all bitstrings in parallel for unitary circuits. For circuits with non-unitary channels that are not terminal measurements (see below), the method of quantum trajectories is used and one bitstring is sampled per trajectory, leading to multiple final states.</p>
<p>Final state history can be reset as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">clear_final_states</span><span class="p">()</span>
<span class="n">sim</span><span class="o">.</span><span class="n">final_states</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulating-noisy-circuits">
<h2>Simulating noisy circuits<a class="headerlink" href="#simulating-noisy-circuits" title="Permalink to this heading">#</a></h2>
<p>If your <code class="docutils literal notranslate"><span class="pre">apply_op</span></code> function can apply channels, you can use <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> to simulate noisy circuits through quantum trajectores. An example using <code class="docutils literal notranslate"><span class="pre">cirq.protocols.act_on</span></code>, which can apply channels, is shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="n">cirq</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="n">noisy</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">with_noise</span><span class="p">(</span><span class="n">cirq</span><span class="o">.</span><span class="n">depolarize</span><span class="p">(</span><span class="mf">0.05</span><span class="p">))</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">bgls</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">cirq</span><span class="o">.</span><span class="n">StateVectorSimulationState</span><span class="p">(</span>
        <span class="n">qubits</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">initial_state</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">),</span>
    <span class="n">apply_op</span><span class="o">=</span><span class="n">cirq</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">act_on</span><span class="p">,</span>
    <span class="n">compute_probability</span><span class="o">=</span><span class="n">bgls</span><span class="o">.</span><span class="n">born</span><span class="o">.</span><span class="n">compute_probability_state_vector</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">noisy</span> <span class="o">+</span> <span class="n">cirq</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">repetitions</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">cirq</span><span class="o">.</span><span class="n">plot_state_histogram</span><span class="p">(</span><span class="n">results</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b905fd8985f3a206e8a4605b5fe4eaa9e7b66f06666ff254c306576973954319.png" src="_images/b905fd8985f3a206e8a4605b5fe4eaa9e7b66f06666ff254c306576973954319.png" />
</div>
</div>
<section id="how-to-modify-apply-op-to-support-channels">
<h3>How to modify <code class="docutils literal notranslate"><span class="pre">apply_op</span></code> to support channels<a class="headerlink" href="#how-to-modify-apply-op-to-support-channels" title="Permalink to this heading">#</a></h3>
<p>You can modify your <code class="docutils literal notranslate"><span class="pre">apply_op</span></code> function to support channels as follows. The simplest case is when the probability of a Kraus operator does not depend on the state. In this case, you can use the <code class="docutils literal notranslate"><span class="pre">cirq.mixture</span></code> protocol to obtain <code class="docutils literal notranslate"><span class="pre">(probability,</span> <span class="pre">kraus_operator)</span></code> pairs as in the example below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">channel</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">DepolarizingChannel</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">cirq</span><span class="o">.</span><span class="n">mixture</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((0.99,
  array([[1., 0.],
         [0., 1.]])),
 (0.0033333333333333335,
  array([[0.+0.j, 1.+0.j],
         [1.+0.j, 0.+0.j]])),
 (0.0033333333333333335,
  array([[0.+0.j, 0.-1.j],
         [0.+1.j, 0.+0.j]])),
 (0.0033333333333333335,
  array([[ 1.+0.j,  0.+0.j],
         [ 0.+0.j, -1.+0.j]])))
</pre></div>
</div>
</div>
</div>
<p>Now, you just need to select a Kraus operator according to the probability distribution and then apply it to the state.</p>
<p>If the channel does not support the <code class="docutils literal notranslate"><span class="pre">cirq.mixture</span></code> protocol (i.e., if the probability of applying a Kraus operator depends on the state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>), you can still use this method by first using <code class="docutils literal notranslate"><span class="pre">cirq.kraus</span></code> to obtain the Kraus operators <span class="math notranslate nohighlight">\(K_i\)</span> of the channel, then computing the probability of applying each channel via <span class="math notranslate nohighlight">\(p_i = \langle \psi | K_i^\dagger K_i |\psi\rangle\)</span>.</p>
<blockquote>
<div><p>Note: For noiseless simulation, <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> updates all bitstrings in parallel via one evolution of the state. This isn’t possible in quantum trajectories because many different states are generated, so you should expect noisy simulation to be slower.</p>
</div></blockquote>
</section>
</section>
<section id="simulating-circuits-with-intermediate-measurements">
<h2>Simulating circuits with intermediate measurements<a class="headerlink" href="#simulating-circuits-with-intermediate-measurements" title="Permalink to this heading">#</a></h2>
<p>In the same manner described above, <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> can simulate circuits with intermediate measurements if <code class="docutils literal notranslate"><span class="pre">apply_op</span></code> supports channels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">a</span><span class="p">),</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">a</span><span class="p">),</span>  <span class="c1"># &lt;-- Intermediate measurement.</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
    <span class="n">cirq</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">clear_final_states</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">repetitions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cirq</span><span class="o">.</span><span class="n">plot_state_histogram</span><span class="p">(</span><span class="n">results</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/248fda3cf3650fb2a174e426d04fda3263fd916c0c27b5737eef12dfd5483c2a.png" src="_images/248fda3cf3650fb2a174e426d04fda3263fd916c0c27b5737eef12dfd5483c2a.png" />
</div>
</div>
<p>Here the final states are <span class="math notranslate nohighlight">\(|00\rangle\)</span> or <span class="math notranslate nohighlight">\(|11\rangle\)</span> with equal probability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">final_state</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">final_states</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final state:&quot;</span><span class="p">,</span> <span class="n">cirq</span><span class="o">.</span><span class="n">dirac_notation</span><span class="p">(</span><span class="n">final_state</span><span class="o">.</span><span class="n">target_tensor</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final state: |00⟩
Final state: |00⟩
Final state: |00⟩
Final state: |00⟩
Final state: |11⟩
Final state: |11⟩
Final state: |11⟩
Final state: |11⟩
Final state: |00⟩
Final state: |11⟩
</pre></div>
</div>
</div>
</div>
</section>
<section id="can-i-use-bgls-with-qiskit-pennylane-etc">
<h2>Can I use <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> with Qiskit / Pennylane / etc.?<a class="headerlink" href="#can-i-use-bgls-with-qiskit-pennylane-etc" title="Permalink to this heading">#</a></h2>
<p>The only accepted circuit type for <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> is <code class="docutils literal notranslate"><span class="pre">cirq.Circuit</span></code>, but you can convert most popular circuit types to and from Cirq. For example, if you have a Qiskit circuit specified by the following Qasm string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qasm</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">OPENQASM 2.0;</span>
<span class="s2">include &quot;qelib1.inc&quot;;</span>

<span class="s2">qreg q[2];</span>

<span class="s2">h q[0];</span>
<span class="s2">cx q[0],q[1];&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>You can convert this to a Cirq circuit as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cirq.contrib.qasm_import</span> <span class="kn">import</span> <span class="n">circuit_from_qasm</span>

<span class="n">circuit_from_qasm</span><span class="p">(</span><span class="n">qasm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="overflow: auto; white-space: pre;">q_0: ───H───@───
            │
q_1: ───────X───</pre></div></div>
</div>
<p>This circuit can now be used with <code class="docutils literal notranslate"><span class="pre">BGLS</span></code>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="how_it_works.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> works</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="using_custom_states.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Using custom states with <code class="docutils literal notranslate"><span class="pre">BGLS</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Alex Shapiro, Ryan LaRose
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Features</a><ul>
<li><a class="reference internal" href="#accessing-final-states">Accessing final states</a></li>
<li><a class="reference internal" href="#simulating-noisy-circuits">Simulating noisy circuits</a><ul>
<li><a class="reference internal" href="#how-to-modify-apply-op-to-support-channels">How to modify <code class="docutils literal notranslate"><span class="pre">apply_op</span></code> to support channels</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulating-circuits-with-intermediate-measurements">Simulating circuits with intermediate measurements</a></li>
<li><a class="reference internal" href="#can-i-use-bgls-with-qiskit-pennylane-etc">Can I use <code class="docutils literal notranslate"><span class="pre">BGLS</span></code> with Qiskit / Pennylane / etc.?</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>